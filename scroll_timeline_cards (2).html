<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Timeline GSAP Cards</title>
  <link href="https://fonts.googleapis.com/css2?family=Work+Sans:wght@600&family=Azaret+Mono&display=swap" rel="stylesheet">
  <style>
body { margin:0; background:transparent; font-family:'Work Sans',sans-serif; color:#fff; }
.timeline-container { position:relative; width:100vw; min-height:400vh; }
.timeline-svg {
  position:absolute; top:0; left:0; width:100vw; height:100%;
  pointer-events:none; z-index:1;
}
path { fill:none; stroke:url(#gradientStroke); stroke-width:3.5; }
circle.dot { fill:#ff4e27; filter:drop-shadow(0 0 10px #ff4e27bb); }
.card-step {
  position:absolute; min-width:260px; max-width:340px;
  opacity:0; pointer-events:auto; z-index:3;
  transition: box-shadow .3s, opacity .3s;
  will-change: transform, opacity;
  cursor:pointer;
  transform: translate(-50%, 0);
}
.card {
  background:rgba(30,30,30,0.94); 
  border:1.5px solid #ff4e27aa;
  border-radius:18px;
  padding:20px 24px;
  box-shadow: 0 4px 48px #0008;
  backdrop-filter: blur(14px) saturate(120%);
  transition:box-shadow .2s;
}
.card:hover { box-shadow: 0 2px 36px #ff4e27cc; }
.card h3 { font-size:22px; margin:0 0 10px; text-transform:uppercase; letter-spacing:.03em; }
.card p { font-size:13px; font-family:'Azaret Mono',monospace; margin:0; }
.overlay {
  position:fixed; inset:0;
  background: transparent;
  display:none; align-items:center; justify-content:center;
  z-index:20;
  backdrop-filter: blur(3px) saturate(130%);
}
.overlay .content {
  background:rgba(30,30,34,0.57);
  color:#fff;
  padding:44px 36px 34px;
  border-radius:22px;
  max-width:520px; width:96%;
  box-shadow:0 8px 80px 0 #000b, 0 0 0 2.5px #fff3 inset;
  backdrop-filter: blur(26px) saturate(135%);
  border:1.2px solid rgba(255,255,255,0.18);
  position:relative;
  overflow:hidden;
}
.overlay .content:before {
  content:'';
  position:absolute; inset:0;
  z-index:1;
  pointer-events:none;
  background-image: url('data:image/svg+xml;utf8,<svg viewBox="0 0 350 160" fill="none" xmlns="http://www.w3.org/2000/svg"><filter id="noiseFilter"><feTurbulence type="fractalNoise" baseFrequency="0.75" numOctaves="3" stitchTiles="stitch"/></filter><rect width="100%" height="100%" filter="url(%23noiseFilter)" opacity="0.23"/></svg>');
  opacity:.23;
  mix-blend-mode:soft-light;
}
.overlay .content h2 { margin:0 0 18px; }
body, html, .timeline-container {
  scrollbar-width: none;
  -ms-overflow-style: none;
}
body::-webkit-scrollbar,
html::-webkit-scrollbar,
.timeline-container::-webkit-scrollbar {
  display: none;
}
  </style>
</head>
<body>
  <div class="timeline-container" id="container">
    <svg class="timeline-svg" id="timelineSvg">
      <defs>
        <linearGradient id="gradientStroke" x1="0" y1="0" x2="1" y2="1">
          <stop offset="0%" stop-color="#FF4E27" />
          <stop offset="100%" stop-color="#ffffff11" />
        </linearGradient>
      </defs>
      <path id="path"></path>
      <circle class="dot" id="dot" r="10"></circle>
    </svg>
  </div>
  <div class="overlay" id="overlay"><div class="content" id="overlayContent"></div></div>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>
  <script>
    gsap.registerPlugin(ScrollTrigger);

    const stations = [
      { title:'Bauherrenanfrage', content:'Erste Kontaktaufnahme und Klärung der Grundvoraussetzungen.' },
      { title:'Erstgespräch', content:'Persönliches Kennenlernen und Vorstellung erster Ideen.' },
      { title:'Planungsauftrag', content:'Erteilung des Auftrags zur Erstellung einer ersten Entwurfsplanung.' },
      { title:'Entwurfsphase', content:'Erarbeitung von Grundrissvarianten und Visualisierungen.' },
      { title:'Kostenabschätzung', content:'Grobe Kostenschätzung.' },
      { title:'Bauantrag', content:'Erstellung und Einreichung aller relevanten Unterlagen für die Baugenehmigung.' },
      { title:'Ausführungsplanung', content:'Detaillierte Planung aller Bauausführungen und Abstimmung mit den Gewerken.' },
      { title:'Vergabe', content:'Einholung und Auswertung der Angebote, Auswahl der Unternehmen.' },
      { title:'Bauausführung', content:'Umsetzung des Bauvorhabens bis zur Fertigstellung und Übergabe.' }
    ];

    const container = document.getElementById('container');
    const svg = document.getElementById('timelineSvg');
    const pathEl = document.getElementById('path');
    const dot = document.getElementById('dot');
    const overlay = document.getElementById('overlay');
    const overlayContent = document.getElementById('overlayContent');

    function getCardPositions() {
      const vw = window.innerWidth;
      const totalHeight = container.offsetHeight;
      const minTop = window.innerHeight * 0.18;
      const maxTop = totalHeight - window.innerHeight * 0.18;
      return stations.map((_, i) => {
        const y = minTop + (i / (stations.length - 1)) * (maxTop - minTop);
        const x = (i % 2 ? vw * 0.74 : vw * 0.26);
        return { x, y };
      });
    }

    function drawPath(cardPositions) {
      let d = `M${cardPositions[0].x},${cardPositions[0].y}`;
      for(let i=1;i<cardPositions.length;i++) {
        d += ` L${cardPositions[i].x},${cardPositions[i].y}`;
      }
      pathEl.setAttribute('d', d.trim());
    }

    const cardEls = [];
    function createCards(cardPositions) {
      container.innerHTML = '';
      container.appendChild(svg);
      cardEls.length = 0;
      stations.forEach((st, i) => {
        const cardWrap = document.createElement('div');
        cardWrap.className = 'card-step';
        cardWrap.innerHTML = `<div class='card'><h3>${st.title}</h3><p>${st.content}</p></div>`;
        cardWrap.style.left = `${cardPositions[i].x}px`;
        cardWrap.style.top = `${cardPositions[i].y}px`;
        container.appendChild(cardWrap);
        cardEls.push(cardWrap);
        cardWrap.querySelector('.card').addEventListener('click', ()=>{
          overlayContent.innerHTML = `<h2>${st.title}</h2><p>${st.content}</p>`;
          overlay.style.display = 'flex';
        });
      });
    }

    function setCardVisibility() {
      const vh = window.innerHeight;
      cardEls.forEach(card => {
        const cardRect = card.getBoundingClientRect();
        if(cardRect.top < vh * 0.9 && cardRect.bottom > vh * 0.1){
          card.style.opacity = 1;
        } else {
          card.style.opacity = 0;
        }
      });
    }

    function updateEverything() {
      svg.style.height = container.offsetHeight + 'px';

      const cardPositions = getCardPositions();
      createCards(cardPositions);
      drawPath(cardPositions);

      let length = pathEl.getTotalLength();
      pathEl.style.strokeDasharray = length;
      pathEl.style.strokeDashoffset = length;

      ScrollTrigger.killAll();
      ScrollTrigger.create({
        trigger: ".timeline-container",
        start: "top top",
        end: "bottom bottom",
        scrub: 1,
        onUpdate: self => {
          pathEl.style.strokeDashoffset = length * (1 - self.progress);
          const pt = pathEl.getPointAtLength(length * self.progress);
          dot.setAttribute('cx', pt.x);
          dot.setAttribute('cy', pt.y);
        }
      });

      setCardVisibility();
    }

    overlay.addEventListener('click', ()=> overlay.style.display='none');
    window.addEventListener('scroll', setCardVisibility);
    window.addEventListener('resize', updateEverything);

    setTimeout(updateEverything, 50);
  </script>
</body>
</html>
